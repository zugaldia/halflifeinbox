var app=angular.module("halfLife",["ngRoute"]);app.config(["$routeProvider",function(a){a.when("/",{templateUrl:"static/partials/main.html",controller:"MainCtrl"});a.otherwise({redirectTo:"/"})}]);
app.controller("MainCtrl",["$scope","$log",function(a,g){a.data={avoidWeekends:!1,startFirstDay:!1,firstDay:100,lastDay:10,totalDays:14,decayRate:null,halfLife:null,emailPlan:null};a.data.firstDay=100;a.data.lastDay=10;a.data.totalDays=14;a.data.decayRate=null;a.data.halfLife=null;a.data.emailPlan=null;var e="Jan Feb Mar Apr May Jun Jul Aug Sep Oct Nov Dec".split(" ");a.$watch("data.firstDay",function(b,c,d){a.updateExponentialDecay()});a.$watch("data.lastDay",function(b,c,d){a.updateExponentialDecay()});
a.$watch("data.totalDays",function(b,c,d){a.updateExponentialDecay()});a.onAvoidWeekendsChange=function(){a.updateExponentialDecay()};a.onStartFirstDayChange=function(){a.updateExponentialDecay()};a.getDecayRate=function(a,c,d){return-1/a*Math.log(1*c/d)};a.getExponentialDecay=function(a,c,d){return 1*a*Math.exp(-1*c*d)};a.getHalfLife=function(a){return 1*Math.log(2)/a};a.isWeekend=function(a){return 6===a.getDay()||0===a.getDay()};a.updateExponentialDecay=function(){a.data.decayRate=a.getDecayRate(a.data.totalDays,
a.data.lastDay,a.data.firstDay);a.data.halfLife=Math.ceil(a.getHalfLife(a.data.decayRate));var b=new Date;a.data.startFirstDay&&b.setDate(b.getDate()-1);a.data.emailPlan=[];for(var c=0;c<a.data.totalDays+1;c++){var d=Math.ceil(a.getExponentialDecay(a.data.firstDay,a.data.decayRate,c));if(a.data.avoidWeekends)for(;a.isWeekend(b);)b.setDate(b.getDate()+1);var f=b.getUTCDate()+" "+e[b.getUTCMonth()];a.data.emailPlan.push({day:c,formattedDate:f,remaining:d,totalDay:0<a.data.emailPlan.length?a.data.emailPlan[c-
1].remaining-d:-1});b.setDate(b.getDate()+1)}}}]);
